services:
  webstudio:
    build: .
    container_name: webstudio-x00ossw4sogoso80kck480ow
    restart: always
    environment:
      # --- Configuración de Base de Datos ---
      DATABASE_URL: '${DATABASE_URL}'
      DIRECT_URL: '${DIRECT_URL}'
      POSTGREST_API_KEY: '${POSTGREST_API_KEY}'
      POSTGREST_URL: '${POSTGREST_URL}'
      
      # --- Configuración de OAuth / Auth ---
      GOOGLE_CLIENT_ID: '${GOOGLE_CLIENT_ID}'
      GOOGLE_CLIENT_SECRET: '${GOOGLE_CLIENT_SECRET}'
      AUTH_SECRET: '${AUTH_SECRET}'
      
      # --- Forzado de Protocolo (Crucial para el Error 400) ---
      NODE_ENV: production
      TRUST_PROXY: 'true'
      APP_URL: 'http://builder.recomiend.app'
      PUBLIC_URL: 'http://builder.recomiend.app'
      
      # --- Otras Variables ---
      FEATURES: '${FEATURES}'
      USER_PLAN: '${USER_PLAN}'
      MAX_ASSETS_PER_PROJECT: '${MAX_ASSETS_PER_PROJECT}'
      MAX_UPLOAD_SIZE: '${MAX_UPLOAD_SIZE}'
      DEPLOYMENT_ENVIRONMENT: '${DEPLOYMENT_ENVIRONMENT}'
    
    ports:
      - '3001:3000' # Puerto que mapeas al exterior (aunque Traefik usa el interno)
    

    networks:
      - x00ossw4sogoso80kck480ow
      - coolify
networks:
  x00ossw4sogoso80kck480ow:
    name: x00ossw4sogoso80kck480ow
    external: true
  coolify:
    external: true